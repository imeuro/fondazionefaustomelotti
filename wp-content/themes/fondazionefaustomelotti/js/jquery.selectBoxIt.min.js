/* jquery.selectBoxIt - v3.8.1 - 2013-10-17
* http://www.selectboxit.com
* Copyright (c) 2013 Greg Franko; Licensed MIT*/
(function(a){a(window.jQuery,window,document)}(function(a,e,b,d){a.widget("selectBox.selectBoxIt",{VERSION:"3.8.1",options:{showEffect:"none",showEffectOptions:{},showEffectSpeed:"medium",hideEffect:"none",hideEffectOptions:{},hideEffectSpeed:"medium",showFirstOption:true,defaultText:"",defaultIcon:"",downArrowIcon:"",theme:"default",keydownOpen:true,isMobile:function(){var f=navigator.userAgent||navigator.vendor||e.opera;return(/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/).test(f)},"native":false,aggressiveChange:false,selectWhenHidden:true,viewport:a(e),similarSearch:false,copyAttributes:["title","rel"],copyClasses:"button",nativeMousedown:false,customShowHideEvent:false,autoWidth:true,html:true,populate:"",dynamicPositioning:true,hideCurrent:false},getThemes:function(){var f=this,g=a(f.element).attr("data-theme")||"c";return{bootstrap:{focus:"active",hover:"",enabled:"enabled",disabled:"disabled",arrow:"caret",button:"btn",list:"dropdown-menu",container:"bootstrap",open:"open"},jqueryui:{focus:"ui-state-focus",hover:"ui-state-hover",enabled:"ui-state-enabled",disabled:"ui-state-disabled",arrow:"ui-icon ui-icon-triangle-1-s",button:"ui-widget ui-state-default",list:"ui-widget ui-widget-content",container:"jqueryui",open:"selectboxit-open"},jquerymobile:{focus:"ui-btn-down-"+g,hover:"ui-btn-hover-"+g,enabled:"ui-enabled",disabled:"ui-disabled",arrow:"ui-icon ui-icon-arrow-d ui-icon-shadow",button:"ui-btn ui-btn-icon-right ui-btn-corner-all ui-shadow ui-btn-up-"+g,list:"ui-btn ui-btn-icon-right ui-btn-corner-all ui-shadow ui-btn-up-"+g,container:"jquerymobile",open:"selectboxit-open"},"default":{focus:"selectboxit-focus",hover:"selectboxit-hover",enabled:"selectboxit-enabled",disabled:"selectboxit-disabled",arrow:"selectboxit-default-arrow",button:"selectboxit-btn",list:"selectboxit-list",container:"selectboxit-container",open:"selectboxit-open"}}},isDeferred:function(f){return a.isPlainObject(f)&&f.promise&&f.done},_create:function(f){var h=this,g=h.options.populate,i=h.options.theme;if(!h.element.is("select")){return}h.widgetProto=a.Widget.prototype;h.originalElem=h.element[0];h.selectBox=h.element;if(h.options.populate&&h.add&&!f){h.add(g)}h.selectItems=h.element.find("option");h.firstSelectItem=h.selectItems.slice(0,1);h.documentHeight=a(b).height();h.theme=a.isPlainObject(i)?a.extend({},h.getThemes()["default"],i):h.getThemes()[i]?h.getThemes()[i]:h.getThemes()["default"];h.currentFocus=0;h.blur=true;h.textArray=[];h.currentIndex=0;h.currentText="";h.flipped=false;if(!f){h.selectBoxStyles=h.selectBox.attr("style")}h._createDropdownButton()._createUnorderedList()._copyAttributes()._replaceSelectBox()._addClasses(h.theme)._eventHandlers();if(h.originalElem.disabled&&h.disable){h.disable()}if(h._ariaAccessibility){h._ariaAccessibility()}h.isMobile=h.options.isMobile();if(h._mobile){h._mobile()}if(h.options["native"]){this._applyNativeSelect()}h.triggerEvent("create");return h},_createDropdownButton:function(){var k=this,g=k.originalElemId=k.originalElem.id||"",i=k.originalElemValue=k.originalElem.value||"",h=k.originalElemName=k.originalElem.name||"",f=k.options.copyClasses,j=k.selectBox.attr("class")||"";k.dropdownText=a("<span/>",{id:g&&g+"SelectBoxItText","class":"selectboxit-text",unselectable:"on",text:k.firstSelectItem.text()}).attr("data-val",i);k.dropdownImageContainer=a("<span/>",{"class":"selectboxit-option-icon-container"});k.dropdownImage=a("<i/>",{id:g&&g+"SelectBoxItDefaultIcon","class":"selectboxit-default-icon",unselectable:"on"});k.dropdown=a("<span/>",{id:g&&g+"SelectBoxIt","class":"selectboxit "+(f==="button"?j:"")+" "+(k.selectBox.prop("disabled")?k.theme.disabled:k.theme.enabled),name:h,tabindex:k.selectBox.attr("tabindex")||"0",unselectable:"on"}).append(k.dropdownImageContainer.append(k.dropdownImage)).append(k.dropdownText);k.dropdownContainer=a("<span/>",{id:g&&g+"SelectBoxItContainer","class":"selectboxit-container "+k.theme.container+" "+(f==="container"?j:"")}).append(k.dropdown);return k},_createUnorderedList:function(){var w=this,m,s,t,o,p,q,r,j="",u=w.originalElemId||"",f=a("<ul/>",{id:u&&u+"SelectBoxItOptions","class":"selectboxit-options",tabindex:-1}),h,i,g,l,k,v;if(!w.options.showFirstOption){w.selectItems.first().attr("disabled","disabled");w.selectItems=w.selectBox.find("option").slice(1)}w.selectItems.each(function(x){k=a(this);s="";t="";m=k.prop("disabled");o=k.attr("data-icon")||"";p=k.attr("data-iconurl")||"";q=p?"selectboxit-option-icon-url":"";r=p?"style=\"background-image:url('"+p+"');\"":"";h=k.attr("data-selectedtext");i=k.attr("data-text");l=i?i:k.text();v=k.parent();if(v.is("optgroup")){s="selectboxit-optgroup-option";if(k.index()===0){t='<span class="selectboxit-optgroup-header '+v.first().attr("class")+'"data-disabled="true">'+v.first().attr("label")+"</span>"}}k.attr("value",this.value);j+=t+'<li data-id="'+x+'" data-val="'+this.value+'" data-disabled="'+m+'" class="'+s+" selectboxit-option "+(a(this).attr("class")||"")+'"><a class="selectboxit-option-anchor"><span class="selectboxit-option-icon-container"><i class="selectboxit-option-icon '+o+" "+(q||w.theme.container)+'"'+r+"></i></span>"+(w.options.html?l:w.htmlEscape(l))+"</a></li>";g=k.attr("data-search");w.textArray[x]=m?"":g?g:l;if(this.selected){w._setText(w.dropdownText,h||l);w.currentFocus=x}});if((w.options.defaultText||w.selectBox.attr("data-text"))){var n=w.options.defaultText||w.selectBox.attr("data-text");w._setText(w.dropdownText,n);w.options.defaultText=n}f.append(j);w.list=f;w.dropdownContainer.append(w.list);w.listItems=w.list.children("li");w.listAnchors=w.list.find("a");w.listItems.first().addClass("selectboxit-option-first");w.listItems.last().addClass("selectboxit-option-last");w.list.find("li[data-disabled='true']").not(".optgroupHeader").addClass(w.theme.disabled);w.dropdownImage.addClass(w.selectBox.attr("data-icon")||w.options.defaultIcon||w.listItems.eq(w.currentFocus).find("i").attr("class"));w.dropdownImage.attr("style",w.listItems.eq(w.currentFocus).find("i").attr("style"));return w},_replaceSelectBox:function(){var k=this,h,j=k.originalElem.id||"",l=k.selectBox.attr("data-size"),i=k.listSize=l===d?"auto":l==="0"||"size"==="auto"?"auto":+l,f,g;k.selectBox.css("display","none").after(k.dropdownContainer);k.dropdownContainer.appendTo("body").addClass("selectboxit-rendering");h=k.dropdown.height();k.downArrow=a("<i/>",{id:j&&j+"SelectBoxItArrow","class":"selectboxit-arrow",unselectable:"on"});k.downArrowContainer=a("<span/>",{id:j&&j+"SelectBoxItArrowContainer","class":"selectboxit-arrow-container",unselectable:"on"}).append(k.downArrow);k.dropdown.append(k.downArrowContainer);k.listItems.removeClass("selectboxit-selected").eq(k.currentFocus).addClass("selectboxit-selected");f=k.downArrowContainer.outerWidth(true);g=k.dropdownImage.outerWidth(true);if(k.options.autoWidth){k.dropdown.css({width:"auto"}).css({width:k.list.outerWidth(true)+f+g+30});k.list.css({"min-width":k.dropdown.width()})}k.dropdownText.css({"max-width":k.dropdownContainer.outerWidth(true)-(f+g)});k.selectBox.after(k.dropdownContainer);k.dropdownContainer.removeClass("selectboxit-rendering");if(a.type(i)==="number"){k.maxHeight=k.listAnchors.outerHeight(true)*i}return k},_scrollToView:function(n){var m=this,h=m.listItems.eq(m.currentFocus),l=m.list.scrollTop(),g=h.height(),j=h.position().top,f=Math.abs(j),k=m.list.height(),i;if(n==="search"){if(k-j<g){m.list.scrollTop(l+(j-(k-g)))}else{if(j<-1){m.list.scrollTop(j-g)}}}else{if(n==="up"){if(j<-1){m.list.scrollTop(l-f)}}else{if(n==="down"){if(k-j<g){m.list.scrollTop((l+(f-k+g)))}}}}return m},_callbackSupport:function(f){var g=this;if(a.isFunction(f)){f.call(g,g.dropdown)}return g},_setText:function(g,f){var h=this;if(h.options.html){g.html(f)}else{g.text(f)}return h},open:function(f){var i=this,j=i.options.showEffect,l=i.options.showEffectSpeed,k=i.options.showEffectOptions,h=i.options["native"],g=i.isMobile;if(!i.listItems.length||i.dropdown.hasClass(i.theme.disabled)){return i}if((!h&&!g)&&!this.list.is(":visible")){i.triggerEvent("open");if(i._dynamicPositioning&&i.options.dynamicPositioning){i._dynamicPositioning()}if(j==="none"){i.list.show()}else{if(j==="show"||j==="slideDown"||j==="fadeIn"){i.list[j](l)}else{i.list.show(j,k,l)}}i.list.promise().done(function(){i._scrollToView("search");i.triggerEvent("opened")})}i._callbackSupport(f);return i},close:function(f){var l=this,g=l.options.hideEffect,i=l.options.hideEffectSpeed,h=l.options.hideEffectOptions,k=l.options["native"],j=l.isMobile;if((!k&&!j)&&l.list.is(":visible")){l.triggerEvent("close");if(g==="none"){l.list.hide()}else{if(g==="hide"||g==="slideUp"||g==="fadeOut"){l.list[g](i)}else{l.list.hide(g,h,i)}}l.list.promise().done(function(){l.triggerEvent("closed")})}l._callbackSupport(f);return l},toggle:function(){var g=this,f=g.list.is(":visible");if(f){g.close()}else{if(!f){g.open()}}},_keyMappings:{"38":"up","40":"down","13":"enter","8":"backspace","9":"tab","32":"space","27":"esc"},_keydownMethods:function(){var g=this,f=g.list.is(":visible")||!g.options.keydownOpen;return{down:function(){if(g.moveDown&&f){g.moveDown()}},up:function(){if(g.moveUp&&f){g.moveUp()}},enter:function(){var h=g.listItems.eq(g.currentFocus);g._update(h);if(h.attr("data-preventclose")!=="true"){g.close()}g.triggerEvent("enter")},tab:function(){g.triggerEvent("tab-blur");g.close()},backspace:function(){g.triggerEvent("backspace")},esc:function(){g.close()}}},_eventHandlers:function(){var m=this,k=m.options.nativeMousedown,h=m.options.customShowHideEvent,f,g,i=m.focusClass,j=m.hoverClass,l=m.openClass;this.dropdown.on({"click.selectBoxIt":function(){m.dropdown.trigger("focus",true);if(!m.originalElem.disabled){m.triggerEvent("click");if(!k&&!h){m.toggle()}}},"mousedown.selectBoxIt":function(){a(this).data("mdown",true);m.triggerEvent("mousedown");if(k&&!h){m.toggle()}},"mouseup.selectBoxIt":function(){m.triggerEvent("mouseup")},"blur.selectBoxIt":function(){if(m.blur){m.triggerEvent("blur");m.close();a(this).removeClass(i)}},"focus.selectBoxIt":function(n,o){var p=a(this).data("mdown");a(this).removeData("mdown");if(!p&&!o){setTimeout(function(){m.triggerEvent("tab-focus")},0)}if(!o){if(!a(this).hasClass(m.theme.disabled)){a(this).addClass(i)}m.triggerEvent("focus")}},"keydown.selectBoxIt":function(o){var n=m._keyMappings[o.keyCode],p=m._keydownMethods()[n];if(p){p();if(m.options.keydownOpen&&(n==="up"||n==="down")){m.open()}}if(p&&n!=="tab"){o.preventDefault()}},"keypress.selectBoxIt":function(p){var o=p.charCode||p.keyCode,q=m._keyMappings[p.charCode||p.keyCode],n=String.fromCharCode(o);if(m.search&&(!q||(q&&q==="space"))){m.search(n,true,true)}if(q==="space"){p.preventDefault()}},"mouseenter.selectBoxIt":function(){m.triggerEvent("mouseenter")},"mouseleave.selectBoxIt":function(){m.triggerEvent("mouseleave")}});m.list.on({"mouseover.selectBoxIt":function(){m.blur=false},"mouseout.selectBoxIt":function(){m.blur=true},"focusin.selectBoxIt":function(){m.dropdown.trigger("focus",true)}});m.list.on({"mousedown.selectBoxIt":function(){m._update(a(this));m.triggerEvent("option-click");if(a(this).attr("data-disabled")==="false"&&a(this).attr("data-preventclose")!=="true"){m.close()}setTimeout(function(){m.dropdown.trigger("focus",true)},0)},"focusin.selectBoxIt":function(){m.listItems.not(a(this)).removeAttr("data-active");a(this).attr("data-active","");var n=m.list.is(":hidden");if((m.options.searchWhenHidden&&n)||m.options.aggressiveChange||(n&&m.options.selectWhenHidden)){m._update(a(this))}a(this).addClass(i)},"mouseup.selectBoxIt":function(){if(k&&!h){m._update(a(this));m.triggerEvent("option-mouseup");if(a(this).attr("data-disabled")==="false"&&a(this).attr("data-preventclose")!=="true"){m.close()}}},"mouseenter.selectBoxIt":function(){if(a(this).attr("data-disabled")==="false"){m.listItems.removeAttr("data-active");a(this).addClass(i).attr("data-active","");m.listItems.not(a(this)).removeClass(i);a(this).addClass(i);m.currentFocus=+a(this).attr("data-id")}},"mouseleave.selectBoxIt":function(){if(a(this).attr("data-disabled")==="false"){m.listItems.not(a(this)).removeClass(i).removeAttr("data-active");a(this).addClass(i);m.currentFocus=+a(this).attr("data-id")}},"blur.selectBoxIt":function(){a(this).removeClass(i)}},".selectboxit-option");m.list.on({"click.selectBoxIt":function(n){n.preventDefault()}},"a");m.selectBox.on({"change.selectBoxIt, internal-change.selectBoxIt":function(p,q){var o,n;if(!q){o=m.list.find('li[data-val="'+m.originalElem.value+'"]');if(o.length){m.listItems.eq(m.currentFocus).removeClass(m.focusClass);m.currentFocus=+o.attr("data-id")}}o=m.listItems.eq(m.currentFocus);n=o.attr("data-selectedtext");f=o.attr("data-text");g=f?f:o.find("a").text();m._setText(m.dropdownText,n||g);m.dropdownText.attr("data-val",m.originalElem.value);if(o.find("i").attr("class")){m.dropdownImage.attr("class",o.find("i").attr("class")).addClass("selectboxit-default-icon");m.dropdownImage.attr("style",o.find("i").attr("style"))}m.triggerEvent("changed")},"disable.selectBoxIt":function(){m.dropdown.addClass(m.theme.disabled)},"enable.selectBoxIt":function(){m.dropdown.removeClass(m.theme.disabled)},"open.selectBoxIt":function(){var o=m.list.find("li[data-val='"+m.dropdownText.attr("data-val")+"']"),n;if(!o.length){o=m.listItems.not("[data-disabled=true]").first()}m.currentFocus=+o.attr("data-id");n=m.listItems.eq(m.currentFocus);m.dropdown.addClass(l).removeClass(j).addClass(i);m.listItems.removeClass(m.selectedClass).removeAttr("data-active").not(n).removeClass(i);n.addClass(m.selectedClass).addClass(i);if(m.options.hideCurrent){m.listItems.show();n.hide()}},"close.selectBoxIt":function(){m.dropdown.removeClass(l)},"blur.selectBoxIt":function(){m.dropdown.removeClass(i)},"mouseenter.selectBoxIt":function(){if(!a(this).hasClass(m.theme.disabled)){m.dropdown.addClass(j)}},"mouseleave.selectBoxIt":function(){m.dropdown.removeClass(j)},destroy:function(n){n.preventDefault();n.stopPropagation()}});return m},_update:function(k){var l=this,f,g,i,j=l.options.defaultText||l.selectBox.attr("data-text"),h=l.listItems.eq(l.currentFocus);if(k.attr("data-disabled")==="false"){f=l.listItems.eq(l.currentFocus).attr("data-selectedtext");g=h.attr("data-text");i=g?g:h.text();if((j&&l.options.html?l.dropdownText.html()===j:l.dropdownText.text()===j)&&l.selectBox.val()===k.attr("data-val")){l.triggerEvent("change")}else{l.selectBox.val(k.attr("data-val"));l.currentFocus=+k.attr("data-id");if(l.originalElem.value!==l.dropdownText.attr("data-val")){l.triggerEvent("change")}}}},_addClasses:function(l){var n=this,i=n.focusClass=l.focus,j=n.hoverClass=l.hover,g=l.button,k=l.list,f=l.arrow,h=l.container,m=n.openClass=l.open;n.selectedClass="selectboxit-selected";n.downArrow.addClass(n.selectBox.attr("data-downarrow")||n.options.downArrowIcon||f);n.dropdownContainer.addClass(h);n.dropdown.addClass(g);n.list.addClass(k);return n},refresh:function(f,g){var h=this;h._destroySelectBoxIt()._create(true);if(!g){h.triggerEvent("refresh")}h._callbackSupport(f);return h},htmlEscape:function(f){return String(f).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},triggerEvent:function(g){var h=this,f=h.options.showFirstOption?h.currentFocus:((h.currentFocus-1)>=0?h.currentFocus:0);h.selectBox.trigger(g,{selectbox:h.selectBox,selectboxOption:h.selectItems.eq(f),dropdown:h.dropdown,dropdownOption:h.listItems.eq(h.currentFocus)});return h},_copyAttributes:function(){var f=this;if(f._addSelectBoxAttributes){f._addSelectBoxAttributes()}return f},_realOuterWidth:function(g){if(g.is(":visible")){return g.outerWidth(true)}var i=this,f=g.clone(),h;f.css({visibility:"hidden",display:"block",position:"absolute"}).appendTo("body");h=f.outerWidth(true);f.remove();return h}});var c=a.selectBox.selectBoxIt.prototype;c.add=function(g,f){this._populate(g,function(h){var n=this,j=a.type(h),o,p=0,i,k=[],l=n._isJSON(h),m=l&&n._parseJSON(h);if(h&&(j==="array"||(l&&m.data&&a.type(m.data)==="array"))||(j==="object"&&h.data&&a.type(h.data)==="array")){if(n._isJSON(h)){h=m}if(h.data){h=h.data}for(i=h.length;p<=i-1;p+=1){o=h[p];if(a.isPlainObject(o)){k.push(a("<option/>",o))}else{if(a.type(o)==="string"){k.push(a("<option/>",{text:o,value:o}))}}}n.selectBox.append(k)}else{if(h&&j==="string"&&!n._isJSON(h)){n.selectBox.append(h)}else{if(h&&j==="object"){n.selectBox.append(a("<option/>",h))}else{if(h&&n._isJSON(h)&&a.isPlainObject(n._parseJSON(h))){n.selectBox.append(a("<option/>",n._parseJSON(h)))}}}}if(n.dropdown){n.refresh(function(){n._callbackSupport(f)},true)}else{n._callbackSupport(f)}return n})};c._parseJSON=function(f){return(JSON&&JSON.parse&&JSON.parse(f))||a.parseJSON(f)};c._isJSON=function(f){var i=this,h;try{h=i._parseJSON(f);return true}catch(g){return false}};c._populate=function(g,f){var h=this;g=a.isFunction(g)?g.call():g;if(h.isDeferred(g)){g.done(function(i){f.call(h,i)})}else{f.call(h,g)}return h};c._ariaAccessibility=function(){var g=this,f=a("label[for='"+g.originalElem.id+"']");g.dropdownContainer.attr({role:"combobox","aria-autocomplete":"list","aria-haspopup":"true","aria-expanded":"false","aria-owns":g.list[0].id});g.dropdownText.attr({"aria-live":"polite"});g.dropdown.on({"disable.selectBoxIt":function(){g.dropdownContainer.attr("aria-disabled","true")},"enable.selectBoxIt":function(){g.dropdownContainer.attr("aria-disabled","false")}});if(f.length){g.dropdownContainer.attr("aria-labelledby",f[0].id)}g.list.attr({role:"listbox","aria-hidden":"true"});g.listItems.attr({role:"option"});g.selectBox.on({"open.selectBoxIt":function(){g.list.attr("aria-hidden","false");g.dropdownContainer.attr("aria-expanded","true")},"close.selectBoxIt":function(){g.list.attr("aria-hidden","true");g.dropdownContainer.attr("aria-expanded","false")}});return g};c._addSelectBoxAttributes=function(){var f=this;f._addAttributes(f.selectBox.prop("attributes"),f.dropdown);f.selectItems.each(function(g){f._addAttributes(a(this).prop("attributes"),f.listItems.eq(g))});return f};c._addAttributes=function(f,g){var h=this,i=h.options.copyAttributes;if(f.length){a.each(f,function(j,k){var l=(k.name).toLowerCase(),m=k.value;if(m!=="null"&&(a.inArray(l,i)!==-1||l.indexOf("data")!==-1)){g.attr(l,m)}})}return h};c.destroy=function(f){var g=this;g._destroySelectBoxIt();g.widgetProto.destroy.call(g);g._callbackSupport(f);return g};c._destroySelectBoxIt=function(){var f=this;f.dropdown.off(".selectBoxIt");if(a.contains(f.dropdownContainer[0],f.originalElem)){f.dropdownContainer.before(f.selectBox)}f.dropdownContainer.remove();f.selectBox.removeAttr("style").attr("style",f.selectBoxStyles);f.triggerEvent("destroy");return f};c.disable=function(f){var g=this;if(!g.options.disabled){g.close();g.selectBox.attr("disabled","disabled");g.dropdown.removeAttr("tabindex").removeClass(g.theme.enabled).addClass(g.theme.disabled);g.setOption("disabled",true);g.triggerEvent("disable")}g._callbackSupport(f);return g};c.disableOption=function(j,f){var k=this,g,h,i,l=a.type(j);if(l==="number"){k.close();g=k.selectBox.find("option").eq(j);k.triggerEvent("disable-option");g.attr("disabled","disabled");k.listItems.eq(j).attr("data-disabled","true").addClass(k.theme.disabled);if(k.currentFocus===j){h=k.listItems.eq(k.currentFocus).nextAll("li").not("[data-disabled='true']").first().length;i=k.listItems.eq(k.currentFocus).prevAll("li").not("[data-disabled='true']").first().length;if(h){k.moveDown()}else{if(i){k.moveUp()}else{k.disable()}}}}k._callbackSupport(f);return k};c._isDisabled=function(f){var g=this;if(g.originalElem.disabled){g.disable()}return g};c._dynamicPositioning=function(){var l=this;if(a.type(l.listSize)==="number"){l.list.css("max-height",l.maxHeight||"none")}else{var h=l.dropdown.offset().top,g=l.list.data("max-height")||l.list.outerHeight(),k=l.dropdown.outerHeight(),n=l.options.viewport,o=n.height(),p=a.isWindow(n.get(0))?n.scrollTop():n.offset().top,m=(h+k+g<=o+p),f=!m;if(!l.list.data("max-height")){l.list.data("max-height",l.list.outerHeight())}if(!f){l.list.css("max-height",g);l.list.css("top","auto")}else{if((l.dropdown.offset().top-p)>=g){l.list.css("max-height",g);l.list.css("top",(l.dropdown.position().top-l.list.outerHeight()))}else{var i=Math.abs((h+k+g)-(o+p)),j=Math.abs((l.dropdown.offset().top-p)-g);if(i<j){l.list.css("max-height",g-i-(k/2));l.list.css("top","auto")}else{l.list.css("max-height",g-j-(k/2));l.list.css("top",(l.dropdown.position().top-l.list.outerHeight()))}}}}return l};c.enable=function(f){var g=this;if(g.options.disabled){g.triggerEvent("enable");g.selectBox.removeAttr("disabled");g.dropdown.attr("tabindex",0).removeClass(g.theme.disabled).addClass(g.theme.enabled);g.setOption("disabled",false);g._callbackSupport(f)}return g};c.enableOption=function(k,f){var l=this,h,g=0,i,j,m=a.type(k);if(m==="number"){h=l.selectBox.find("option").eq(k);l.triggerEvent("enable-option");h.removeAttr("disabled");l.listItems.eq(k).attr("data-disabled","false").removeClass(l.theme.disabled)}l._callbackSupport(f);return l};c.moveDown=function(f){var i=this;i.currentFocus+=1;var g=i.listItems.eq(i.currentFocus).attr("data-disabled")==="true"?true:false,h=i.listItems.eq(i.currentFocus).nextAll("li").not("[data-disabled='true']").first().length;if(i.currentFocus===i.listItems.length){i.currentFocus-=1}else{if(g&&h){i.listItems.eq(i.currentFocus-1).blur();i.moveDown();return}else{if(g&&!h){i.currentFocus-=1}else{i.listItems.eq(i.currentFocus-1).blur().end().eq(i.currentFocus).focusin();i._scrollToView("down");i.triggerEvent("moveDown")}}}i._callbackSupport(f);return i};c.moveUp=function(f){var i=this;i.currentFocus-=1;var g=i.listItems.eq(i.currentFocus).attr("data-disabled")==="true"?true:false,h=i.listItems.eq(i.currentFocus).prevAll("li").not("[data-disabled='true']").first().length;if(i.currentFocus===-1){i.currentFocus+=1}else{if(g&&h){i.listItems.eq(i.currentFocus+1).blur();i.moveUp();return}else{if(g&&!h){i.currentFocus+=1}else{i.listItems.eq(this.currentFocus+1).blur().end().eq(i.currentFocus).focusin();i._scrollToView("up");i.triggerEvent("moveUp")}}}i._callbackSupport(f);return i};c._setCurrentSearchOption=function(f){var g=this;if((g.options.aggressiveChange||g.options.selectWhenHidden||g.listItems.eq(f).is(":visible"))&&g.listItems.eq(f).data("disabled")!==true){g.listItems.eq(g.currentFocus).blur();g.currentIndex=f;g.currentFocus=f;g.listItems.eq(g.currentFocus).focusin();g._scrollToView("search");g.triggerEvent("search")}return g};c._searchAlgorithm=function(h,f){var l=this,k=false,n,o,g,i,m=l.textArray,j=l.currentText;for(n=h,g=m.length;n<g;n+=1){i=m[n];for(o=0;o<g;o+=1){if(m[o].search(f)!==-1){k=true;o=g}}if(!k){l.currentText=l.currentText.charAt(l.currentText.length-1).replace(/[|()\[{.+*?$\\]/g,"\\$0");j=l.currentText}f=new RegExp(j,"gi");if(j.length<3){f=new RegExp(j.charAt(0),"gi");if((i.charAt(0).search(f)!==-1)){l._setCurrentSearchOption(n);if((i.substring(0,j.length).toLowerCase()!==j.toLowerCase())||l.options.similarSearch){l.currentIndex+=1}return false}}else{if((i.search(f)!==-1)){l._setCurrentSearchOption(n);return false}}if(i.toLowerCase()===l.currentText.toLowerCase()){l._setCurrentSearchOption(n);l.currentText="";return false}}return true};c.search=function(f,g,h){var j=this;if(h){j.currentText+=f.replace(/[|()\[{.+*?$\\]/g,"\\$0")}else{j.currentText=f.replace(/[|()\[{.+*?$\\]/g,"\\$0")}var i=j._searchAlgorithm(j.currentIndex,new RegExp(j.currentText,"gi"));if(i){j._searchAlgorithm(0,j.currentText)}j._callbackSupport(g);return j};c._updateMobileText=function(){var i=this,g,f,h;g=i.selectBox.find("option").filter(":selected");f=g.attr("data-text");h=f?f:g.text();i._setText(i.dropdownText,h);if(i.list.find('li[data-val="'+g.val()+'"]').find("i").attr("class")){i.dropdownImage.attr("class",i.list.find('li[data-val="'+g.val()+'"]').find("i").attr("class")).addClass("selectboxit-default-icon")}};c._applyNativeSelect=function(){var f=this;f.dropdownContainer.append(f.selectBox);f.dropdown.attr("tabindex","-1");f.selectBox.css({display:"block",visibility:"visible",width:f._realOuterWidth(f.dropdown),height:f.dropdown.outerHeight(),opacity:"0",position:"absolute",top:"0",left:"0",cursor:"pointer","z-index":"999999",margin:f.dropdown.css("margin"),padding:"0","-webkit-appearance":"menulist-button"});if(f.originalElem.disabled){f.triggerEvent("disable")}return this};c._mobileEvents=function(){var f=this;f.selectBox.on({"changed.selectBoxIt":function(){f.hasChanged=true;f._updateMobileText();f.triggerEvent("option-click")},"mousedown.selectBoxIt":function(){if(!f.hasChanged&&f.options.defaultText&&!f.originalElem.disabled){f._updateMobileText();f.triggerEvent("option-click")}},"enable.selectBoxIt":function(){f.selectBox.removeClass("selectboxit-rendering")},"disable.selectBoxIt":function(){f.selectBox.addClass("selectboxit-rendering")}})};c._mobile=function(f){var g=this;if(g.isMobile){g._applyNativeSelect();g._mobileEvents()}return this};c.remove=function(j,f){var k=this,h=a.type(j),l,m=0,g,i="";if(h==="array"){for(g=j.length;m<=g-1;m+=1){l=j[m];if(a.type(l)==="number"){if(i.length){i+=", option:eq("+l+")"}else{i+="option:eq("+l+")"}}}k.selectBox.find(i).remove()}else{if(h==="number"){k.selectBox.find("option").eq(j).remove()}else{k.selectBox.find("option").remove()}}if(k.dropdown){k.refresh(function(){k._callbackSupport(f)},true)}else{k._callbackSupport(f)}return k};c.selectOption=function(i,f){var g=this,h=a.type(i);if(h==="number"){g.selectBox.val(g.selectItems.eq(i).val()).change()}else{if(h==="string"){g.selectBox.val(i).change()}}g._callbackSupport(f);return g};c.setOption=function(g,i,f){var h=this;if(a.type(g)==="string"){h.options[g]=i}h.refresh(function(){h._callbackSupport(f)},true);return h};c.setOptions=function(g,f){var h=this;if(a.isPlainObject(g)){h.options=a.extend({},h.options,g)}h.refresh(function(){h._callbackSupport(f)},true);return h};c.wait=function(h,f){var g=this;g.widgetProto._delay.call(g,f,h);return g}}));